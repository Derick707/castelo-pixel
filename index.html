<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Dark Pixel Castle</title>
<style>
  body {
    margin: 0;
    background: black;
    overflow: hidden;
    font-family: monospace;
  }
  canvas {
    image-rendering: pixelated;
  }
  #menu {
    position: absolute;
    right: 60px;
    bottom: 60px;
    color: #ffb347;
    text-align: right;
  }
  .option {
    font-size: 22px;
    margin: 8px 0;
    cursor: pointer;
  }
</style>
</head>
<body>

<canvas id="game"></canvas>

<div id="menu">
  <div style="font-size:32px;">START GAME</div>
  <div class="option">▶ 1 PLAYER</div>
  <div class="option">2 PLAYERS</div>
  <div class="option">EXIT</div>
</div>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

const PIXEL = 6; // tamanho dos "pixels"

// FUNÇÃO PRA DESENHAR PIXEL
function px(x, y, color){
  ctx.fillStyle = color;
  ctx.fillRect(x * PIXEL, y * PIXEL, PIXEL, PIXEL);
}

// CÉU GRADIENTE ESCURO
function drawSky(){
  let grad = ctx.createLinearGradient(0,0,0,canvas.height);
  grad.addColorStop(0,"#05070d");
  grad.addColorStop(1,"#0b0f1a");
  ctx.fillStyle = grad;
  ctx.fillRect(0,0,canvas.width,canvas.height);
}

// LUA PIXELADA
function drawMoon(){
  let cx = 20, cy = 12;
  for(let y=-8;y<8;y++){
    for(let x=-8;x<8;x++){
      if(x*x + y*y < 60){
        px(cx+x, cy+y, "#cfd8dc");
      }
    }
  }
}

// CASTELO PIXEL ART
function drawCastle(){
  const baseY = Math.floor(canvas.height/PIXEL) - 35;
  const centerX = Math.floor(canvas.width/PIXEL/2);

  // TORRE ESQUERDA
  for(let y=0;y<30;y++){
    for(let x=0;x<10;x++){
      px(centerX-25+x, baseY+y, "#2b2f3a");
    }
  }

  // TORRE DIREITA
  for(let y=0;y<30;y++){
    for(let x=0;x<10;x++){
      px(centerX+15+x, baseY+y, "#2b2f3a");
    }
  }

  // CORPO CENTRAL
  for(let y=10;y<35;y++){
    for(let x=-15;x<15;x++){
      px(centerX+x, baseY+y, "#3a3f4f");
    }
  }

  // PORTA
  for(let y=25;y<35;y++){
    for(let x=-3;x<3;x++){
      px(centerX+x, baseY+y, "#1a1a1a");
    }
  }

  // JANELAS
  px(centerX-20, baseY+10, "#ffd966");
  px(centerX+20, baseY+10, "#ffd966");
}

// ÁRVORES PIXELADAS
function drawTree(xBase){
  let baseY = Math.floor(canvas.height/PIXEL) - 20;

  // TRONCO
  for(let y=0;y<6;y++){
    px(xBase, baseY+y, "#4b2e19");
  }

  // COPA
  for(let y=-6;y<0;y++){
    for(let x=-3;x<4;x++){
      if(Math.random()>0.2)
        px(xBase+x, baseY+y, "#0f2f0f");
    }
  }
}

// CHUVA
let rain = [];
for(let i=0;i<200;i++){
  rain.push({
    x: Math.random()*canvas.width/PIXEL,
    y: Math.random()*canvas.height/PIXEL
  });
}

function drawRain(){
  ctx.fillStyle = "#7fbfff";
  rain.forEach(r=>{
    px(r.x, r.y, "#7fbfff");
    r.y += 0.8;
    if(r.y > canvas.height/PIXEL) r.y = 0;
  });
}

// RELÂMPAGO
let flash = 0;
function lightning(){
  if(Math.random() < 0.002){
    flash = 10;
  }
  if(flash > 0){
    ctx.fillStyle = "rgba(255,255,255,0.15)";
    ctx.fillRect(0,0,canvas.width,canvas.height);
    flash--;
  }
}

// LOOP
function loop(){
  drawSky();
  drawMoon();
  drawCastle();
  drawTree(30);
  drawTree(50);
  drawTree(80);
  drawRain();
  lightning();
  requestAnimationFrame(loop);
}

loop();

// SOM SOMBRIO 8-BIT
const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
function playDarkMusic(){
  const osc = audioCtx.createOscillator();
  const gain = audioCtx.createGain();
  osc.type = "square";
  osc.frequency.setValueAtTime(110, audioCtx.currentTime);
  gain.gain.setValueAtTime(0.03, audioCtx.currentTime);
  osc.connect(gain);
  gain.connect(audioCtx.destination);
  osc.start();
}
document.body.addEventListener("click", playDarkMusic, {once:true});
</script>
</body>
</html>
