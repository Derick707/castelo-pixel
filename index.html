<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Dark Pixel Castle</title>
<style>
body{
  margin:0;
  overflow:hidden;
  background:black;
  font-family:monospace;
  color:white;
}

/* FUNDO COM SUA IMAGEM */
.bg{
  position:fixed;
  inset:0;
  background:url("bg.png") center/cover no-repeat;
  image-rendering:pixelated;
  z-index:-3;
}

/* CANVAS DAS ANIMA√á√ïES */
canvas{
  position:fixed;
  inset:0;
  z-index:-2;
}

/* FLASH DO REL√ÇMPAGO */
.flash{
  position:fixed;
  inset:0;
  background:white;
  opacity:0;
  pointer-events:none;
  z-index:-1;
}

.title{
  position:absolute;
  right:8%;
  top:25%;
  font-size:42px;
  color:#ff9d2e;
  text-shadow:4px 4px 0 #000;
}

.menu{
  position:absolute;
  right:8%;
  top:40%;
  font-size:32px;
}
.menu div{ margin:14px 0; }
.arrow{ display:inline-block; width:32px; color:#ff9d2e; }
</style>
</head>
<body>

<div class="bg"></div>
<div class="flash" id="flash"></div>
<canvas id="c"></canvas>

<div class="title">START GAME</div>
<div class="menu">
  <div><span class="arrow">‚ñ∂</span>1 PLAYER</div>
  <div><span class="arrow"></span>2 PLAYERS</div>
  <div><span class="arrow"></span>EXIT</div>
</div>

<script>
const canvas=document.getElementById("c");
const ctx=canvas.getContext("2d");
const flash=document.getElementById("flash");

function resize(){
  canvas.width=innerWidth;
  canvas.height=innerHeight;
}
resize();
addEventListener("resize",resize);

/* üåßÔ∏è CHUVA */
let rain=[];
for(let i=0;i<350;i++){
 rain.push({x:Math.random()*canvas.width,y:Math.random()*canvas.height,l:10+Math.random()*15,s:4+Math.random()*4});
}

function drawRain(){
 ctx.strokeStyle="rgba(180,200,255,0.45)";
 ctx.lineWidth=1;
 rain.forEach(r=>{
  ctx.beginPath();
  ctx.moveTo(r.x,r.y);
  ctx.lineTo(r.x,r.y+r.l);
  ctx.stroke();
  r.y+=r.s;
  if(r.y>canvas.height){r.y=-20;r.x=Math.random()*canvas.width;}
 });
}

/* üå´Ô∏è N√âVOA */
let fog=[];
for(let i=0;i<6;i++){
 fog.push({x:Math.random()*canvas.width,y:100+Math.random()*300,s:0.2+Math.random()*0.3});
}

function drawFog(){
 ctx.fillStyle="rgba(200,200,255,0.05)";
 fog.forEach(f=>{
  ctx.beginPath();
  ctx.arc(f.x,f.y,150,0,Math.PI*2);
  ctx.fill();
  f.x+=f.s;
  if(f.x>canvas.width+200)f.x=-200;
 });
}

/* ‚ö° REL√ÇMPAGO */
function lightning(){
 if(Math.random()<0.004){
   flash.style.opacity=0.85;
   setTimeout(()=>flash.style.opacity=0,120);
 }
}

function animate(){
 ctx.clearRect(0,0,canvas.width,canvas.height);
 drawFog();
 drawRain();
 lightning();
 requestAnimationFrame(animate);
}
animate();

/* üéµ M√öSICA 8-BIT SOMBRIA */
const audioCtx=new (window.AudioContext||window.webkitAudioContext)();
function tone(freq,time){
 const osc=audioCtx.createOscillator();
 const gain=audioCtx.createGain();
 osc.type="square";
 osc.frequency.value=freq;
 osc.connect(gain);
 gain.connect(audioCtx.destination);
 osc.start();
 gain.gain.setValueAtTime(0.07,audioCtx.currentTime);
 gain.gain.exponentialRampToValueAtTime(0.001,audioCtx.currentTime+time);
 osc.stop(audioCtx.currentTime+time);
}

let notes=[196,220,174,196,147,174,196,220];
let n=0;
setInterval(()=>{tone(notes[n],0.3);n=(n+1)%notes.length;},360);

// Navegadores s√≥ liberam som ap√≥s intera√ß√£o
document.body.addEventListener("click",()=>audioCtx.resume());

/* üéÆ MENU */
let menuIndex=0;
const items=document.querySelectorAll(".menu div");
function updateMenu(){
 items.forEach((it,i)=>it.querySelector(".arrow").textContent=i===menuIndex?"‚ñ∂":"");
}
document.addEventListener("keydown",e=>{
 if(e.key==="ArrowUp"){menuIndex=(menuIndex-1+3)%3;updateMenu();}
 if(e.key==="ArrowDown"){menuIndex=(menuIndex+1)%3;updateMenu();}
 if(e.key==="Enter"){alert("Selecionado: "+items[menuIndex].innerText);}
});
</script>
</body>
</html>
